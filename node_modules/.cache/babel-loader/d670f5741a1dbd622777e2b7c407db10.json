{"ast":null,"code":"import _toConsumableArray from\"/Users/gabrieldeleon/code/GA-Project-4/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/Users/gabrieldeleon/code/GA-Project-4/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/gabrieldeleon/code/GA-Project-4/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/gabrieldeleon/code/GA-Project-4/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import Header from'../../components/Header';import AddPlaylist from'../../components/AddPlaylist';import PlaylistFeed from'../../components/PlaylistFeed';import*as postsAPI from'../../utils/postApi';import*as likesAPI from'../../utils/likesApi';import{SimpleGrid}from'@mantine/core';import{DEFAULT_THEME,LoadingOverlay,MediaQuery}from'@mantine/core';import ErrorMessage from'../../components/ErrorMessage/ErrorMessage';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Timeline(_ref){var loggedInUser=_ref.loggedInUser,logout=_ref.logout;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),posts=_useState4[0],setPosts=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];function addLike(_x){return _addLike.apply(this,arguments);}function _addLike(){_addLike=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(postId){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return likesAPI.create(postId);case 3:response=_context.sent;console.log(response,'<--- THE RESPONSE FROM ADD LIKE!');getPosts();_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0,'<--- THE ERROR FROM THE SERVER!');case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return _addLike.apply(this,arguments);}function removeLike(_x2){return _removeLike.apply(this,arguments);}function _removeLike(){_removeLike=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(likeId){var response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return likesAPI.removeLike(likeId);case 3:response=_context2.sent;console.log(response,'REMOVED LIKE');getPosts();_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);setError(\"Error in removing like!\");case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return _removeLike.apply(this,arguments);}function handleDeletePost(_x3){return _handleDeletePost.apply(this,arguments);}function _handleDeletePost(){_handleDeletePost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(postId){var response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return postsAPI.deletePost(postId);case 3:response=_context3.sent;console.log(response,'<---- DELETED POST');_context3.next=11;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);setError(\"Error in deleting post!\");case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return _handleDeletePost.apply(this,arguments);}function handleAddPost(_x4){return _handleAddPost.apply(this,arguments);}function _handleAddPost(){_handleAddPost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(post){var response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;console.log('CREATING POST!');_context4.next=4;return postsAPI.create(post);case 4:response=_context4.sent;console.log(response);setPosts([].concat(_toConsumableArray(posts),[response.data]));_context4.next=12;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0.message);case 12:case\"end\":return _context4.stop();}}},_callee4,null,[[0,9]]);}));return _handleAddPost.apply(this,arguments);}function getPosts(){return _getPosts.apply(this,arguments);}function _getPosts(){_getPosts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var response;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return postsAPI.getAll();case 3:response=_context5.sent;console.log(response,'<--- RESPONSE DATA');setPosts(_toConsumableArray(response.data));setLoading(false);_context5.next=13;break;case 9:_context5.prev=9;_context5.t0=_context5[\"catch\"](0);console.log(_context5.t0.message,\"<--- ERROR in USE EFFECT\");setLoading(false);case 13:case\"end\":return _context5.stop();}}},_callee5,null,[[0,9]]);}));return _getPosts.apply(this,arguments);}useEffect(function(){getPosts();},[]);if(error){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(ErrorMessage,{error:error}),\";\"]});}var customLoader=/*#__PURE__*/_jsx(\"svg\",{width:\"54\",height:\"54\",viewBox:\"0 0 38 38\",xmlns:\"http://www.w3.org/2000/svg\",stroke:DEFAULT_THEME.colors.blue[6],children:/*#__PURE__*/_jsx(\"g\",{fill:\"none\",fillRule:\"evenodd\",children:/*#__PURE__*/_jsxs(\"g\",{transform:\"translate(1 1)\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"circle\",{strokeOpacity:\".5\",cx:\"18\",cy:\"18\",r:\"18\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M36 18c0-9.94-8.06-18-18-18\",children:/*#__PURE__*/_jsx(\"animateTransform\",{attributeName:\"transform\",type:\"rotate\",from:\"0 18 18\",to:\"360 18 18\",dur:\"1s\",repeatCount:\"indefinite\"})})]})})});if(loading){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(LoadingOverlay,{loader:customLoader,visible:true})]});}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(SimpleGrid,{cols:1,verticalSpacing:\"50\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Header,{loggedInUser:loggedInUser,logout:logout})}),/*#__PURE__*/_jsx(\"div\",{style:{margin:\"0 35% 0 35%\",maxWidth:700},children:/*#__PURE__*/_jsx(AddPlaylist,{handleAddPost:handleAddPost})}),/*#__PURE__*/_jsx(\"div\",{style:{margin:\"0 5% 5% 25%\",maxWidth:800,minWidth:300},children:/*#__PURE__*/_jsx(PlaylistFeed,{loggedInUser:loggedInUser,posts:posts,addLike:addLike,removeLike:removeLike,deletePost:handleDeletePost})})]})});}","map":{"version":3,"names":["React","useEffect","useState","Header","AddPlaylist","PlaylistFeed","postsAPI","likesAPI","SimpleGrid","DEFAULT_THEME","LoadingOverlay","MediaQuery","ErrorMessage","Timeline","loggedInUser","logout","error","setError","posts","setPosts","loading","setLoading","addLike","postId","create","response","console","log","getPosts","removeLike","likeId","handleDeletePost","deletePost","handleAddPost","post","data","message","getAll","customLoader","colors","blue","margin","maxWidth","minWidth"],"sources":["/Users/gabrieldeleon/code/GA-Project-4/src/pages/Timeline/Timeline.jsx"],"sourcesContent":["import React, {useEffect, useState} from 'react';\nimport Header from '../../components/Header';\nimport AddPlaylist from '../../components/AddPlaylist';\nimport PlaylistFeed from '../../components/PlaylistFeed';\nimport * as postsAPI from '../../utils/postApi'; \nimport * as likesAPI from '../../utils/likesApi';\nimport { SimpleGrid } from '@mantine/core';\nimport { DEFAULT_THEME, LoadingOverlay, MediaQuery } from '@mantine/core';\nimport ErrorMessage from '../../components/ErrorMessage/ErrorMessage';\n\nexport default function Timeline({loggedInUser, logout}) {\n\n    const [error, setError] = useState('');\n    const [posts, setPosts] = useState([]);\n    const [loading, setLoading] = useState(true);\n\n    async function addLike(postId) {\n        try {\n            const response = await likesAPI.create(postId);\n            console.log(response, '<--- THE RESPONSE FROM ADD LIKE!');\n            getPosts();\n        } catch(err) {\n            console.log(err, '<--- THE ERROR FROM THE SERVER!')\n        }\n    }\n\n    async function removeLike(likeId) {\n        try {\n            const response = await likesAPI.removeLike(likeId);\n            console.log(response, 'REMOVED LIKE');\n            getPosts();\n        } catch (err) {\n            console.log(err);\n            setError(\"Error in removing like!\");\n        }\n        }\n\n    async function handleDeletePost(postId) {\n        try {\n            const response = await postsAPI.deletePost(postId);\n            console.log(response, '<---- DELETED POST')\n        } catch(err) {\n            console.log(err);\n            setError(\"Error in deleting post!\");\n        }\n    }\n\n\n    async function handleAddPost(post) {\n    \n        try {\n            console.log('CREATING POST!')\n            const response = await postsAPI.create(post);\n            console.log(response);\n            setPosts([...posts, response.data]);\n            \n\n        } catch(err) {\n            console.log(err.message);\n        } \n    }\n\n    async function getPosts() {\n        try {\n            const response = await postsAPI.getAll();\n            console.log(response, '<--- RESPONSE DATA');\n            setPosts([...response.data]);\n            setLoading(false);\n        } catch(err) {\n            console.log(err.message, \"<--- ERROR in USE EFFECT\");\n            setLoading(false);\n        }\n    }\n    \n        useEffect(() => {\n        \n            getPosts()\n        }, [])\n\n    if (error) {\n        return (\n        <>\n            <Header />\n            <ErrorMessage error={error} />;\n        </>\n        );\n    }\n\n    const customLoader = (\n        <svg\n            width=\"54\"\n            height=\"54\"\n            viewBox=\"0 0 38 38\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            stroke={DEFAULT_THEME.colors.blue[6]}\n        >\n            <g fill=\"none\" fillRule=\"evenodd\">\n            <g transform=\"translate(1 1)\" strokeWidth=\"2\">\n                <circle strokeOpacity=\".5\" cx=\"18\" cy=\"18\" r=\"18\" />\n                <path d=\"M36 18c0-9.94-8.06-18-18-18\">\n                <animateTransform\n                    attributeName=\"transform\"\n                    type=\"rotate\"\n                    from=\"0 18 18\"\n                    to=\"360 18 18\"\n                    dur=\"1s\"\n                    repeatCount=\"indefinite\"\n                />\n                </path>\n            </g>\n            </g>\n        </svg>\n    );\n\n    if (loading) {\n        return (\n            <>\n            <Header />\n            <LoadingOverlay loader={customLoader} visible />\n            </>\n        )\n    }\n\n    return(\n\n        <>\n            <SimpleGrid cols={1} verticalSpacing=\"50\">\n                <div><Header loggedInUser={loggedInUser} logout={logout} /></div>\n                <div style={{ margin: \"0 35% 0 35%\", maxWidth: 700 }}><AddPlaylist handleAddPost={handleAddPost} /></div>\n                <div style={{ margin: \"0 5% 5% 25%\", maxWidth: 800, minWidth: 300 }}><PlaylistFeed loggedInUser={loggedInUser} posts={posts} addLike={addLike} removeLike={removeLike} deletePost={handleDeletePost} /></div>\n            </SimpleGrid>\n        </>\n        \n    )\n}"],"mappings":"wgBAAA,MAAOA,MAAP,EAAeC,SAAf,CAA0BC,QAA1B,KAAyC,OAAzC,CACA,MAAOC,OAAP,KAAmB,yBAAnB,CACA,MAAOC,YAAP,KAAwB,8BAAxB,CACA,MAAOC,aAAP,KAAyB,+BAAzB,CACA,MAAO,GAAKC,SAAZ,KAA0B,qBAA1B,CACA,MAAO,GAAKC,SAAZ,KAA0B,sBAA1B,CACA,OAASC,UAAT,KAA2B,eAA3B,CACA,OAASC,aAAT,CAAwBC,cAAxB,CAAwCC,UAAxC,KAA0D,eAA1D,CACA,MAAOC,aAAP,KAAyB,4CAAzB,C,6IAEA,cAAe,SAASC,SAAT,MAA0C,IAAvBC,aAAuB,MAAvBA,YAAuB,CAATC,MAAS,MAATA,MAAS,CAErD,cAA0Bb,QAAQ,CAAC,EAAD,CAAlC,wCAAOc,KAAP,eAAcC,QAAd,eACA,eAA0Bf,QAAQ,CAAC,EAAD,CAAlC,yCAAOgB,KAAP,eAAcC,QAAd,eACA,eAA8BjB,QAAQ,CAAC,IAAD,CAAtC,yCAAOkB,OAAP,eAAgBC,UAAhB,eAJqD,QAMtCC,QANsC,mIAMrD,iBAAuBC,MAAvB,uKAE+BhB,SAAQ,CAACiB,MAAT,CAAgBD,MAAhB,CAF/B,QAEcE,QAFd,eAGQC,OAAO,CAACC,GAAR,CAAYF,QAAZ,CAAsB,kCAAtB,EACAG,QAAQ,GAJhB,+EAMQF,OAAO,CAACC,GAAR,aAAiB,iCAAjB,EANR,oEANqD,kDAgBtCE,WAhBsC,6IAgBrD,kBAA0BC,MAA1B,6KAE+BvB,SAAQ,CAACsB,UAAT,CAAoBC,MAApB,CAF/B,QAEcL,QAFd,gBAGQC,OAAO,CAACC,GAAR,CAAYF,QAAZ,CAAsB,cAAtB,EACAG,QAAQ,GAJhB,mFAMQF,OAAO,CAACC,GAAR,eACAV,QAAQ,CAAC,yBAAD,CAAR,CAPR,sEAhBqD,qDA2BtCc,iBA3BsC,+JA2BrD,kBAAgCR,MAAhC,6KAE+BjB,SAAQ,CAAC0B,UAAT,CAAoBT,MAApB,CAF/B,QAEcE,QAFd,gBAGQC,OAAO,CAACC,GAAR,CAAYF,QAAZ,CAAsB,oBAAtB,EAHR,mFAKQC,OAAO,CAACC,GAAR,eACAV,QAAQ,CAAC,yBAAD,CAAR,CANR,sEA3BqD,2DAsCtCgB,cAtCsC,sJAsCrD,kBAA6BC,IAA7B,sJAGQR,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAHR,uBAI+BrB,SAAQ,CAACkB,MAAT,CAAgBU,IAAhB,CAJ/B,QAIcT,QAJd,gBAKQC,OAAO,CAACC,GAAR,CAAYF,QAAZ,EACAN,QAAQ,8BAAKD,KAAL,GAAYO,QAAQ,CAACU,IAArB,GAAR,CANR,mFAUQT,OAAO,CAACC,GAAR,CAAY,aAAIS,OAAhB,EAVR,sEAtCqD,wDAoDtCR,SApDsC,oIAoDrD,+LAE+BtB,SAAQ,CAAC+B,MAAT,EAF/B,QAEcZ,QAFd,gBAGQC,OAAO,CAACC,GAAR,CAAYF,QAAZ,CAAsB,oBAAtB,EACAN,QAAQ,oBAAKM,QAAQ,CAACU,IAAd,EAAR,CACAd,UAAU,CAAC,KAAD,CAAV,CALR,mFAOQK,OAAO,CAACC,GAAR,CAAY,aAAIS,OAAhB,CAAyB,0BAAzB,EACAf,UAAU,CAAC,KAAD,CAAV,CARR,sEApDqD,2CAgEjDpB,SAAS,CAAC,UAAM,CAEZ2B,QAAQ,GACX,CAHQ,CAGN,EAHM,CAAT,CAKJ,GAAIZ,KAAJ,CAAW,CACP,mBACA,wCACI,KAAC,MAAD,IADJ,cAEI,KAAC,YAAD,EAAc,KAAK,CAAEA,KAArB,EAFJ,OADA,CAMH,CAED,GAAMsB,aAAY,cACd,YACI,KAAK,CAAC,IADV,CAEI,MAAM,CAAC,IAFX,CAGI,OAAO,CAAC,WAHZ,CAII,KAAK,CAAC,4BAJV,CAKI,MAAM,CAAE7B,aAAa,CAAC8B,MAAd,CAAqBC,IAArB,CAA0B,CAA1B,CALZ,uBAOI,UAAG,IAAI,CAAC,MAAR,CAAe,QAAQ,CAAC,SAAxB,uBACA,WAAG,SAAS,CAAC,gBAAb,CAA8B,WAAW,CAAC,GAA1C,wBACI,eAAQ,aAAa,CAAC,IAAtB,CAA2B,EAAE,CAAC,IAA9B,CAAmC,EAAE,CAAC,IAAtC,CAA2C,CAAC,CAAC,IAA7C,EADJ,cAEI,aAAM,CAAC,CAAC,6BAAR,uBACA,yBACI,aAAa,CAAC,WADlB,CAEI,IAAI,CAAC,QAFT,CAGI,IAAI,CAAC,SAHT,CAII,EAAE,CAAC,WAJP,CAKI,GAAG,CAAC,IALR,CAMI,WAAW,CAAC,YANhB,EADA,EAFJ,GADA,EAPJ,EADJ,CA0BA,GAAIpB,OAAJ,CAAa,CACT,mBACI,wCACA,KAAC,MAAD,IADA,cAEA,KAAC,cAAD,EAAgB,MAAM,CAAEkB,YAAxB,CAAsC,OAAO,KAA7C,EAFA,GADJ,CAMH,CAED,mBAEI,sCACI,MAAC,UAAD,EAAY,IAAI,CAAE,CAAlB,CAAqB,eAAe,CAAC,IAArC,wBACI,kCAAK,KAAC,MAAD,EAAQ,YAAY,CAAExB,YAAtB,CAAoC,MAAM,CAAEC,MAA5C,EAAL,EADJ,cAEI,YAAK,KAAK,CAAE,CAAE0B,MAAM,CAAE,aAAV,CAAyBC,QAAQ,CAAE,GAAnC,CAAZ,uBAAsD,KAAC,WAAD,EAAa,aAAa,CAAET,aAA5B,EAAtD,EAFJ,cAGI,YAAK,KAAK,CAAE,CAAEQ,MAAM,CAAE,aAAV,CAAyBC,QAAQ,CAAE,GAAnC,CAAwCC,QAAQ,CAAE,GAAlD,CAAZ,uBAAqE,KAAC,YAAD,EAAc,YAAY,CAAE7B,YAA5B,CAA0C,KAAK,CAAEI,KAAjD,CAAwD,OAAO,CAAEI,OAAjE,CAA0E,UAAU,CAAEO,UAAtF,CAAkG,UAAU,CAAEE,gBAA9G,EAArE,EAHJ,GADJ,EAFJ,CAWH"},"metadata":{},"sourceType":"module"}